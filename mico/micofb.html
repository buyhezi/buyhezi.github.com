<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <title>MiCO用户反馈系信息查询</title>
    <script type="text/javascript" src="./js/jquery-2.1.3.js"></script>
    <script type="text/javascript" src="./js/config.js"></script>
    <script type="text/javascript" src="./js/av-0.5.0.min.js"></script>
    <style>
        .indexno{
            width: 30px;
            background-color: red;
        }        
        .phone{
            width: 120px;
            background-color: yellow;
        }
        .fbtime{
            width: 200px;
            background-color: blue;
        }
        .fbcontent{
            width: 500px;
            background-color: green;
        }
    </style>
</head>
<body>
    <button onclick="getuserfb()">刷新</button>
    <div>
        <div><span class="indexno">序号</span><span class="phone">手机号</span><span class="fbtime">反馈时间</span><span class="fbcontent">反馈信息</span></div>
        <div id="userfb"></div>
    </div>
</body>
<script type="text/javascript">
    (function(window) {
        AV.$ = jQuery;
        //用config.js中的appId，appKey初始化，若你搭建自己的js，请用你的appId与appKey
        AV.initialize(appId, appKey);
    })(window);

    function getuserfb(){
        // 可以先查询出要修改的那条存储
        var Post = AV.Object.extend("feedback");
        // 这个 id 是要修改条目的 objectId，你在生成这个实例并成功保存时可以获取到，请看前面的文档
        var query = new AV.Query(Post);
        query.equalTo("appname", "MicoKit");
        query.find({
          success: function(results) {
            var html = "";
            var i = 1;
            var timestr;
            var timedates;
            // timestr.substring(0,timestr.indexOf("GMT"))
            $.each(results, function(n, value) {
                timestr = value.updatedAt;
                timedates = timestr.getFullYear() +"年"+ (timestr.getMonth()+1)  +"月"+  timestr.getDate() +"日"+  timestr.getHours()+"时";
                html += '<span class="indexno">'+(i++)+'</span> <span class="phone">'+value.get("phone")+'</span> <span class="fbtime">'+ timedates +'</span> <span>'+value.get("fdcontent")+'</span><br/>';
            });
            $("#userfb").html(html);
        },
        error: function(error) {
            alert("error = "+JSON.stringify(error));
        }
    });


    }
</script>
</html>